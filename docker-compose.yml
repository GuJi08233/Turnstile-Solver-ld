services:
  turnstile-solver:
    image: guji0823/api-solver:latest
    ports:
      - "5072:5072"
    volumes:
      - solver-data:/app/data
    environment:
      # 建议设置：用于签名 session cookie（不设置则每次重启会导致登录失效）
      # 可用 `python3 -c "import secrets; print(secrets.token_hex(32))"` 生成
      - SECRET_KEY=${SECRET_KEY:-}
      # OAuth (可选)
      # - LINUXDO_CLIENT_ID=
      # - LINUXDO_CLIENT_SECRET=
      # - LINUXDO_REDIRECT_URI=
      # 管理员 (ADMIN_PASSWORD 必填)
      - ADMIN_USERNAME=admin
      - ADMIN_PASSWORD=admin
      # 支付 (可选)
      # - CREDIT_PID=
      # - CREDIT_KEY=
      # - CREDIT_GATEWAY=
    command: ["--host", "0.0.0.0", "--port", "5072", "--thread", "1"]
    restart: unless-stopped

volumes:
  solver-data:
